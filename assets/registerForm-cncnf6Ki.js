import{r as _}from"./common-kvfjOh1A.js";/* empty css                                                                            *//* empty css                                                                                  *//* empty css                                                                     *//* empty css                                                                         */import D from"./commonButton-CNkRppG-.js";/* empty css                                                                   *//* empty css                                                                     *//* empty css                                                               */import"./mockApi-Bzt-_zo-.js";/* empty css                                                                                       */import{d as F,j as M,z as T,H as L,a as u,b as j,o as V,i as q,m as a,h as g,U as z,g as t,e as n,p as O,t as c,E as w,k as $,u as G,J as x,F as H,G as J,_ as K}from"./index-CH0VdndA.js";import"./commonStore-DKeEGGWD.js";/* empty css                                                                     */const Q=p=>(H("data-v-ce0b7e17"),p=p(),J(),p),W={class:"register-messageBox"},X={class:"register-form-getCodeText"},Y=Q(()=>n("span",null,c("已有账户，去"),-1)),Z=F({__name:"registerForm",setup(p){const C=M("$defultRequest"),b=T(),s=L({username:"",phone:"",smsCaptcha:"",password:"",compPassword:"",elseSee:!1}),m=u(!1),f=u({}),d=u("发送验证码"),h=u(60),v=u({}),y=u({username:[{required:!0,message:"请输入您的姓名",tigger:"change"},{required:!0,message:"请输入您的姓名",tigger:"blur"}],phone:[{required:!0,message:"请输入手机号",tigger:"change"},{required:!0,message:"请输入手机号",tigger:"blur"},{validator:(o,e,r)=>{_.phoneReg.test(e)?r():r(new Error("请输入正确的手机号码"))},trigger:"blur"},{validator:(o,e,r)=>{/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(e)?r():r(new Error("请输入正确的手机号码"))},trigger:"change"}],smsCaptcha:[{required:!0,message:"请输入短信验证码",tigger:"change"},{required:!0,message:"请输入短信验证码",tigger:"blur"}],elseSee:[{validator:(o,e,r)=>{e==!1?r(new Error("请勾选协议")):r()},trigger:"change"}],password:[{required:!0,message:"请输入",tigger:"change"},{required:!0,message:"请输入",tigger:"blur"},{validator:(o,e,r)=>{e.length<17&&e.length>7?_.regex.test(e)?r():r(new Error("密码应同时包含大小写字母和数字，8~16位")):r(new Error("密码应同时包含大小写字母和数字，8~16位"))},trigger:"blur"}],compPassword:[{required:!0,message:"请输入",tigger:"change"},{required:!0,message:"请输入",tigger:"blur"},{validator:(o,e,r)=>{s.password!==s.compPassword?r(new Error("两次输入密码不一致")):r()},trigger:"blur"}]}),R=async()=>{var e;let o=!1;return await((e=f.value)==null?void 0:e.validate(async r=>{r?o=!0:o=!1})),o},S=()=>{var o;d.value=="发送验证码"&&_.phoneReg.test(s.phone)?C.request({url:x.loginOrRegisterApi.sendMessage,method:"get",params:{phoneNumber:s.phone}}).then(()=>{E(60)}).catch(()=>{}):(o=f.value)==null||o.validateField("phone",()=>{})},E=o=>{clearInterval(v.value),h.value=o,v.value=setInterval(()=>{h.value>0?d.value="重新发送"+h.value--:(d.value="发送验证码",clearInterval(v.value))},1e3)},I=()=>{R().then(o=>{o==!0&&(m.value=!0,C.request({url:x.loginOrRegisterApi.putRegisterData,method:"put",data:s}).then(e=>{e.data.state==!0?b.push("/login"):m.value=!1}).catch(e=>{m.value=!1}))})},P=()=>{b.push("/login")},U=()=>{},k=()=>{};return j(()=>{}),(o,e)=>{const r=g("el-input"),i=g("el-form-item"),A=g("el-checkbox"),N=g("el-form"),B=z("loading");return V(),q(N,{ref_key:"formRef",ref:f,class:"register-form","label-position":"top",model:s,rules:y.value},{default:a(()=>[t(i,{label:"姓名",prop:"username"},{default:a(()=>[t(r,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=l=>s.username=l),maxlength:"50",placeholder:"请输入姓名",class:"register-input"},null,8,["modelValue"])]),_:1}),t(i,{label:"手机号码",prop:"phone"},{default:a(()=>[t(r,{modelValue:s.phone,"onUpdate:modelValue":e[1]||(e[1]=l=>s.phone=l),placeholder:"请输入手机号码",class:"register-input"},null,8,["modelValue"])]),_:1}),t(i,{label:"设置密码",prop:"password"},{default:a(()=>[t(r,{modelValue:s.password,"onUpdate:modelValue":e[2]||(e[2]=l=>s.password=l),placeholder:"请输入密码",type:"password",class:"register-input","show-password":""},null,8,["modelValue"])]),_:1}),t(i,{label:"确认密码",prop:"compPassword"},{default:a(()=>[t(r,{modelValue:s.compPassword,"onUpdate:modelValue":e[3]||(e[3]=l=>s.compPassword=l),placeholder:"请确认密码",class:"register-input",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),t(i,{label:"短信验证码",prop:"smsCaptcha"},{default:a(()=>[n("div",W,[t(r,{modelValue:s.smsCaptcha,"onUpdate:modelValue":e[4]||(e[4]=l=>s.smsCaptcha=l),placeholder:"请输入短信验证码",class:"register-input"},{suffix:a(()=>[n("div",{class:"register-form-getCode",onClick:S},[n("div",{class:O([d.value=="发送验证码"?"register-form-getCodeNormal":"register-form-getCodeActive"])},[n("div",X,c(d.value),1)],2)])]),_:1},8,["modelValue"])])]),_:1}),t(i,{label:"",prop:"elseSee"},{default:a(()=>[t(A,{modelValue:s.elseSee,"onUpdate:modelValue":e[5]||(e[5]=l=>s.elseSee=l),name:"elseSee"},null,8,["modelValue"]),n("span",{class:"register-form-elseMessage"},[w(" 已阅读并同意 "),n("a",{style:{color:"#0052d9",cursor:"pointer"},onClick:k},"《用户服务协议》"),w(" 和 "),n("a",{style:{color:"#0052d9",cursor:"pointer"},onClick:U},"《隐私政策》")])]),_:1}),t(i,{label:"",style:{"margin-top":"36px"}},{default:a(()=>[$((V(),q(G(D),{type:"confirm",onCommonClick:I,class:"register-form-submit"},{default:a(()=>[w(c("提交"))]),_:1})),[[B,m.value]])]),_:1}),t(i,{label:""},{default:a(()=>[n("div",{class:"register-toLogin"},[Y,n("span",{style:{color:"#0052d9",cursor:"pointer"},onClick:P},c("登录"))])]),_:1})]),_:1},8,["model","rules"])}}}),ce=K(Z,[["__scopeId","data-v-ce0b7e17"]]);export{ce as default};
